package com.example.chuyendedidong2;import androidx.annotation.NonNull;import androidx.annotation.Nullable;import androidx.appcompat.app.AppCompatActivity;import android.content.Intent;import android.os.Bundle;import android.text.TextUtils;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.ImageView;import android.widget.Toast;import com.example.chuyendedidong2.Model.ProductModel;import com.google.firebase.auth.FirebaseAuth;import com.google.firebase.database.ChildEventListener;import com.google.firebase.database.DataSnapshot;import com.google.firebase.database.DatabaseError;import com.google.firebase.database.DatabaseReference;import com.google.firebase.database.FirebaseDatabase;import com.google.firebase.database.ValueEventListener;import java.util.ArrayList;public class ActivityQuanLySanPham extends AppCompatActivity {    ImageView ivHinh;    EditText edtTen, edtGia, edtSl, edtDes;    Button btnThem;    DiaLogLoanding diaLogLoanding;    FirebaseDatabase database;    FirebaseAuth auth;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_quan_ly_san_pham);        diaLogLoanding = new DiaLogLoanding(this);        database = FirebaseDatabase.getInstance();        auth = FirebaseAuth.getInstance();        setControl();        setEvent();    }    private void setEvent() {        btnThem.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                themSanPham(view);            }        });    }    private void themSanPham(View view) {        String ten = edtTen.getText().toString();        String gia = edtGia.getText().toString();        String sl = edtSl.getText().toString();        String des = edtDes.getText().toString();        diaLogLoanding.ShowDiaLog("Đang thêm sản phẩm...");        if (TextUtils.isEmpty(ten)){            diaLogLoanding.HideDialog();            edtTen.setError("Nhập tên sản phẩm!");            return;        }else if (TextUtils.isEmpty(gia)){            diaLogLoanding.HideDialog();            edtGia.setError("Nhập giá sản phẩm!");            return;        }else if (TextUtils.isEmpty(sl)){            diaLogLoanding.HideDialog();            edtSl.setError("Nhập số lượng sản phẩm!");            return;        }else if (TextUtils.isEmpty(des)){            diaLogLoanding.HideDialog();            edtDes.setError("Nhập chi tiết sản phẩm!");            return;        }        DatabaseReference root = database.getReference("product");        DatabaseReference rootShop = database.getReference("shop");        final String[] nameShop = {""};        rootShop.addValueEventListener(new ValueEventListener() {            @Override            public void onDataChange(@NonNull DataSnapshot snapshot) {                for (DataSnapshot dataSnapshot : snapshot.getChildren()){                    String id = dataSnapshot.child("id").getValue().toString();                    if (id.equals(auth.getUid())){                        nameShop[0] = dataSnapshot.child("name").getValue().toString();                    }                }            }            @Override            public void onCancelled(@NonNull DatabaseError error) {            }        });        String productId = root.push().getKey();        ProductModel product = new ProductModel("",0,ten,Integer.parseInt(gia),Integer.parseInt(sl),des,auth.getUid(), nameShop[0]);        root.child(productId).setValue(product, new DatabaseReference.CompletionListener() {            @Override            public void onComplete(@Nullable DatabaseError error, @NonNull DatabaseReference ref) {                diaLogLoanding.HideDialog();                Toast.makeText(ActivityQuanLySanPham.this, "Thêm thành công!", Toast.LENGTH_SHORT).show();                startActivity(new Intent(ActivityQuanLySanPham.this,HomePageCuaHangActivity.class));            }        });    }    private void setControl() {        ivHinh = findViewById(R.id.ivThemHinhSP);        edtTen = findViewById(R.id.edtThemTenSP);        edtGia = findViewById(R.id.edtThemGiaSP);        edtSl = findViewById(R.id.edtThemSoLuongSP);        edtDes = findViewById(R.id.edtThemChiTietSP);        btnThem = findViewById(R.id.btnThemSP);    }}